describe analytics.abt_subscriber_imei_history;

felt navne
----------
start_date
tac
prev_tac
msisdn
imei14
imei
prev_imei14
prev_imei
end_date
active_record_flag
subscriber_id
subscriber_no
customer_id
origin
prolonging_event
prol_duration
future_cancellation_date
future_cancellation_code
commit_end_date
churn_date
subscriber_id_activation_date
subscriber_id_on_ban_first_activation_date
subscriber_id_on_ban_last_activation_date
sales_date
first_dealer_code
dealer_code
sim
status
is_active
status_reason
dual_sim_master
master_subscriber_id
since_date
additional_title
robinson
accommodation_type
contact_phone_no
analysis_date
analysis
marketing_date
marketing
adr_co_name
adr_district
adr_email
adr_door_no
adr_story
adr_house_letter
adr_country
adr_pob
adr_direction
adr_street_name
adr_house_no
adr_zip
adr_city
adr_primary_ln
adr_secondary_ln
identify
gender
birth_date
middle_initial
first_name
last_business_name
price_plan
campaign
promotion
recipient_operator
equation_group
reason_desc
internal_circuit_id
customer_origin
customer_cvr_no
customer_cpr_no
customer_organization_name
customer_identify
customer_root_customer_id
customer_root_cvr_no
customer_root_cpr_no
customer_root_organization_name
customer_root_identify
customer_cycle_code
customer_tree_level
customer_agncy_code
customer_ar_balance
customer_delinq_status
customer_delinq_sts_date
customer_credit_class
customer_account_type_id
customer_ban_status
customer_payment_method_id
customer_payment_sub_method_id
customer_customer_telno
customer_print_category
customer_employment_type
customer_start_service_date
customer_status_last_date
customer_bl_due_day
customer_since_date
customer_additional_title
customer_robinson
customer_accommodation_type
customer_contact_phone_no
customer_analysis_date
customer_analysis
customer_marketing_date
customer_marketing
customer_adr_co_name
customer_adr_district
customer_adr_email
customer_adr_door_no
customer_adr_story
customer_adr_house_letter
customer_adr_country
customer_adr_pob
customer_adr_direction
customer_adr_street_name
customer_adr_house_no
customer_adr_zip
customer_adr_city
customer_adr_primary_ln
customer_adr_secondary_ln
customer_gender
customer_middle_initial
customer_first_name
customer_last_business_name
customer_start_date
customer_end_date
customer_is_active
customer_birth_date
from_product_product_id
from_product_soc
from_product_campaign
from_product_service_soc
from_product_product_code
from_product_product_desc
from_product_product_lt
from_product_rated_soc
from_product_rated_soc_description
from_product_rated_service_type
from_product_product_type
from_product_product_line
from_product_product_group
from_product_product_subgroup
from_product_budget_product
from_product_budget_product_group
from_product_service_provider
from_product_prim_acc_type
from_product_mdu_mbb
from_product_roaming_segment
from_product_nonstd
from_product_ca_upgrade
from_product_price
from_product_free_voice_dk
from_product_free_sms
from_product_free_mms
from_product_data_mb_incl
from_product_dk_data
from_product_eu_data
from_product_ww_data
from_product_total_data
from_product_service_incl
from_product_service_duration
from_product_extra_datacard
from_product_extra_user
from_product_campaign_desc
from_product_pp_service_type
from_product_pp_soc_description
from_product_promo_service_type
from_product_promo_soc_description
product_product_id
product_soc
product_campaign
product_service_soc
product_product_code
product_product_desc
product_product_lt
product_rated_soc
product_rated_soc_description
product_rated_service_type
product_product_type
product_product_line
product_product_group
product_product_subgroup
product_product_hierarchy
product_budget_product
product_budget_product_group
product_service_provider
product_prim_acc_type
product_mdu_mbb
product_roaming_segment
product_nonstd
product_ca_upgrade
product_price
product_free_voice_dk
product_free_sms
product_free_mms
product_data_mb_incl
product_dk_data
product_eu_data
product_ww_data
product_total_data
product_service_incl
product_service_duration
product_extra_datacard
product_extra_user
product_pp_service_type
product_pp_soc_description
product_promo_service_type
product_promo_soc_description
product_campaign_desc
marketing_name
handset_manufacturer
band
brand_name
handset_model
operating_system
nfc
bluetooth
wlan
device_type
removable_uicc
removable_euicc
nonremovable_uicc
nonremovable_euicc
prev_marketing_name
prev_manufacturer
prev_handset_model
;

-- test 1;
-- subscriber_id can only use one model at a time
select a.*
from   analytics.abt_subscriber_imei_history a,
       analytics.abt_subscriber_imei_history b
where  a.subscriber_id = b.subscriber_id
--and    a.start_date between b.start_date and b.end_date 
and    a.end_date < b.start_date
and    a.end_date > a.end_date
--and    a.msisdn in (40346801,28270897)
;


select subscriber_id,
       start_date,
       end_date,
       imei14,
       prev_imei14,
       handset_model,
       *
from   analytics.abt_subscriber_imei_history
where  msisdn in (40346801,28270897)
order by subscriber_id,    
         msisdn,
         start_date
;